{"version":3,"sources":["ts/gameScore.ts","ts/gameTile.ts","ts/gameBoard.ts","ts/gameToken.ts","ts/main.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AIAA,IAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AACA,IAAA,UAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AACA,IAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AACA,IAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AAEA,IAAM,kBAAkB,GAAG;AACzB,IFJW,AFFA,ACAA,AEAA,YCMG,WAAA,CAAA,SADW;AAEzB,gBAAc,WAAA,CAAA,SAFW;AAGzB,eAAa,UAAA,CAAA,QAHY;AAIzB,gBAAc,WAAA,CAAA;AAJW,CAA3B;AFME,AFSA,AGpBF,ACiBA,IAAM,IAAI,GAEN,YFRF,AFSA,AGpBF;ADWE,AFSA,AGpBF,ACoBE,EAAA,EAAE,EAAE;AAAC,IAAA,IAAI,EAAE,GAAP;AFTJ,AFSA,AGpBF,ACoBkB,IAAA,KAAK,EAAE,GAAnB;AAAwB,IAAA,QAAQ,EAAE,KAAlC;AJCF,AID2C,IAAA,MAAM,EAAE;AJF7C,AGjBR,ACmBI,GADF,OJDM,AGjBR,KAAA,CHiBQ,EGjBQ,CHiBS,AGjBzB,CHiBQ;AENN,AFWA,AGpBF,ACkBA,EAAA,IAAI,EAAE,EJEC,AGpBP,IAAA,CHoBE,EGpBK,CHoBQ,CAAb,EGpBF;ADEA,AFeA,AGpBF,ACqBS,IAAA,IAAI,EFhBX,AEgBa,GAAP,EFhBN,GAAoB,EAApB,oBDDiB;ACSf,AFWD,AGoBF,ACvBmB,IAAA,IFRV,CEQe,EAAE,GAAnB,OFRe,GAAG,CAAA,EAAA,GAAA,MAAK,YAAL,CAAkB,MAAlB,CAAA,MAAyB,IAAzB,IAAyB,EAAA,KAAA,KAAA,CAAzB,GAAyB,EAAzB,GAA6B,GAAnD;AACA,AEO4B,IAAA,MFPvB,EEO+B,EFPpC,AEOsC,GFP1B,CEOR,OFPgB,CAAC,aAAD,CAApB;AACA,ADVA,AGgB4C,IAAA,IFNtC,EEM4C,CHhB7C,CGgB+C,QHhBpD,ICUsB,GAAG,CAAA,EAAA,GAAA,MAAK,YAAL,CAAkB,SAAlB,CAAA,MAA4B,IAA5B,IAA4B,EAAA,KAAA,KAAA,CAA5B,GAA4B,EAA5B,GAAgC,GAAzD;AACA,ADDA,AGMI,GAFJ,OFHK,ADDD,OCCJ,ADDW,GCCI,ADDD,CAAA,EAAA,GAAA,ECCS,CAAC,EDDL,YAAL,CAAkB,CCCT,CAAvB,CDDc,CAAA,MAAsB,IAAtB,IAAsB,EAAA,KAAA,KAAA,CAAtB,GAAsB,EAAtB,GAA0B,EAAxC;ACJF,ADKE,AGMF,EAAA,IAAI,EAAE,GHNC,CAAL,GAAS,QAAQ,CDfV,ACeW,OAAD,CAAjB,QERe;ADShB,AFfC,ACgBA,AGIK,IAAA,IAAI,EHJL,AGIO,GJpBJ,AIoBH,IHJO,CDhBC,ECgBE,CAAA,EAAA,CDhBd,ECgBc,KAAK,YAAL,CAAkB,GAAlB,CAAA,MAAsB,IAAtB,IAAsB,EAAA,KAAA,KAAA,CAAtB,GAAsB,EAAtB,GAA0B,EAAxC;ADfD,ACgBC,AGGgB,IAAA,KAAK,EHHhB,AGGkB,CHHvB,EGGI,CHHK,QAAQ,CAAC,OAAD,CAAjB;AACD,AEXC,ACa4B,IAAA,MDbxB,ECagC,EAAE,CDb7B,IAAT,ACaI,EDbW,CHLP,OAAa;AACrB,AGKE,ACY2C,IAAA,MAAM,CJjB9C,CIiBgD,CDZ9C,EAAL,EHLF,CGKY,EHLE,KAAd,AGKmB,IAAI,CAAC,MAAL,GAAc,QAAd,CAAuB,EAAvB,EAA2B,KAA3B,CAAiC,CAAjC,EAAoC,EAApC,CAAjB;AHJF,AGKE,ACWE,GAHJ,QJbK,EGKE,OHLP,KGKE,CAAkB,IAAlB,EAAwB,EDQT,GCRc,EAA7B,qKHGY,KAAK,MARnB;AEcA,AFJD,AGJG,ACWJ,EAAA,KAAK,EAAE,CFHC,GCRC,IAAL,CDQY,ECRA,CDQG,ICRf,IDQuB,CAAC,aAAT,CAAuB,UAAvB,CAAjB;AAEA,ACRE,ACSI,IAAA,EFDN,EECU,EAAE,GDTL,ACSF,CFDG,CAAC,GCRP,CAAW,KDQb,ECRE,GAAqB,IFdG,KEcxB,wGDYoC,KAAK,OAJ3C;AAQA,ACfE,ACQe,IAAA,KAAK,EFOjB,AEPmB,EDRjB,CCQF,IDRH,CAAW,ODeb,ACfE,CDemB,ECfE,MDeM,ACf3B,CDe4B,OAA9B;AD9BJ,AEgBM,ACO2B,IAAA,GHvBjC,CAAA,IGuByC,CDP9B,CCOgC,EHvB3C,EEgBM,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","file":"main.0e24b174.js","sourceRoot":"..\\src","sourcesContent":["export class GameScore extends HTMLElement {\r\n  get score(): number {\r\n    return this._score;\r\n  }\r\n  set score(value: number) {\r\n    this._score = value;\r\n    this.innerHTML = `\r\n      <style>\r\n        game-score {\r\n          contain: content;\r\n          display: grid;\r\n          place-content: center;\r\n        }\r\n      </style>\r\n      <p>Score: ${this._score}</p>\r\n    `;\r\n  }\r\n\r\n  private _score: number = 0;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.score = 0;\r\n  }\r\n}\r\n","export class GameTile extends HTMLElement {\r\n  x!: number;\r\n  y!: number;\r\n\r\n  connectedCallback() {\r\n    this.innerHTML = `\r\n    <style>\r\n    game-tile {\r\n      display: grid;\r\n      contain: layout size style;\r\n      grid-auto-flow: row;\r\n      place-content: center;\r\n    }\r\n    </style>\r\n    `;\r\n    let xString = this.getAttribute('x') ?? '';\r\n    this.x = parseInt(xString);\r\n\r\n    let yString = this.getAttribute('y') ?? '';\r\n    this.y = parseInt(yString);\r\n  }\r\n}\r\n","import {GameTile} from \"./gameTile\";\r\n\r\nexport class GameBoard extends HTMLElement {\r\n  rows: number;\r\n  columns: number;\r\n  board: GameTile[] = [];\r\n\r\n  static get observedAttributes() {\r\n    return ['rows', 'columns'];\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const rowsAttribute = this.getAttribute('rows') ?? '4';\r\n    this.rows = parseInt(rowsAttribute);\r\n    const columnsAttribute = this.getAttribute('columns') ?? '4';\r\n    this.columns = parseInt(columnsAttribute);\r\n  }\r\n\r\n  private createBoard() {\r\n    const template = document.createElement('template');\r\n\r\n    template.innerHTML = `\r\n      <style>\r\n        game-board {\r\n          display: grid;\r\n          grid-template-columns: repeat(${this.columns}, 1fr);\r\n          contain: content;\r\n        }\r\n      </style>`;\r\n    this.replaceChildren(template.content);\r\n    for (let y = 0; y < this.rows; y++) {\r\n      for (let x = 0; x < this.columns; x++) {\r\n        const gameTile = document.createElement('game-tile') as GameTile;\r\n        gameTile.setAttribute('x', x.toString());\r\n        gameTile.setAttribute('y', y.toString());\r\n\r\n        this.appendChild(gameTile);\r\n        this.board.push(gameTile)\r\n      }\r\n    }\r\n  }\r\n\r\n  connectedCallback() {\r\n    // console.log(\"game-board connected\")\r\n  }\r\n\r\n  attributeChangedCallback() {\r\n    const rowsAttribute = this.getAttribute('rows') ?? '4';\r\n    this.rows = parseInt(rowsAttribute);\r\n    const columnsAttribute = this.getAttribute('columns') ?? '4';\r\n    this.columns = parseInt(columnsAttribute);\r\n    // console.log('attributes changed')\r\n    this.createBoard();\r\n  }\r\n}\r\n","export class GameToken extends HTMLElement {\r\n  value: number = 2;\r\n  id!: string;\r\n  init = true;\r\n\r\n  private oldOffsetTop!: number;\r\n  private oldOffsetLeft!: number;\r\n\r\n  connectedCallback() {\r\n    if (this.init) {\r\n      this.id = \"id\" + Math.random().toString(16).slice(2, 10);\r\n      this.setAttribute('id', this.id);\r\n      this.init = false;\r\n\r\n      this.style.contain = 'content';\r\n      this.style.display = 'grid';\r\n      this.style.placeContent = 'center';\r\n      this.style.placeItems = 'center';\r\n      this.style.position = 'relative';\r\n      this.style.animation = `slide${this.id} 250ms ease-in-out`;\r\n    }\r\n\r\n    this.oldOffsetLeft = this.oldOffsetLeft ?? this.offsetLeft;\r\n    this.oldOffsetTop = this.oldOffsetTop ?? this.offsetTop;\r\n\r\n    this.innerHTML = `\r\n    <style>\r\n      @keyframes slide${this.id} {\r\n        from{\r\n          transform: translate(${this.oldOffsetLeft - this.offsetLeft}px, ${this.oldOffsetTop - this.offsetTop}px);\r\n        }\r\n        to {\r\n          transform: translate(0, 0);\r\n        }\r\n      }\r\n    </style>\r\n    <p>${this.value}</p>\r\n    `\r\n\r\n    // console.info(`Token was at ${this.oldOffsetLeft}px / ${this.oldOffsetTop}px`)\r\n    // console.info(`Connecting Token at ${this.offsetLeft}px / ${this.offsetTop}px`)\r\n    this.oldOffsetTop = this.offsetTop;\r\n    this.oldOffsetLeft = this.offsetLeft;\r\n  }\r\n}\r\n","import {GameScore} from \"./gameScore\";\r\nimport {GameTile} from \"./gameTile\";\r\nimport {GameBoard} from \"./gameBoard\";\r\nimport {GameToken} from \"./gameToken\";\r\n\r\nconst customGameElements = {\r\n  'game-board': GameBoard,\r\n  'game-token': GameToken,\r\n  'game-tile': GameTile,\r\n  'game-score': GameScore,\r\n};\r\n\r\ntype DirectionKey = \"ArrowLeft\" | \"ArrowRight\" | \"ArrowDown\" | \"ArrowUp\";\r\ntype Direction = \"up\" | \"down\" | \"left\" | \"right\";\r\ntype Axis = \"x\" | \"y\";\r\ntype AxisInfo = { cross: Axis; main: Axis; reversed: boolean, length: 'columns' | 'rows' };\r\n\r\nconst axes: {\r\n  [key in Direction]: AxisInfo;\r\n} = {\r\n  up: {main: 'x', cross: 'y', reversed: false, length: 'columns'},\r\n  down: {main: 'x', cross: 'y', reversed: true, length: 'columns'},\r\n  left: {main: 'y', cross: 'x', reversed: false, length: 'rows'},\r\n  right: {main: 'y', cross: 'x', reversed: true, length: 'rows'},\r\n}\r\n\r\nconst keyDirection: {\r\n  [key in DirectionKey]: Direction;\r\n} = {\r\n  \"ArrowLeft\": \"left\",\r\n  \"ArrowRight\": \"right\",\r\n  \"ArrowDown\": \"down\",\r\n  \"ArrowUp\": \"up\"\r\n}\r\nObject.entries(customGameElements).forEach(([element, className]) => {\r\n  console.info(`Registering <${element}>`)\r\n\r\n  customElements.define(element, className);\r\n\r\n});\r\n\r\nconst board = document.getElementsByTagName('game-board')[0] as GameBoard;\r\nconst score = document.getElementsByTagName('game-score')[0] as GameScore;\r\nconst tiles: GameTile[] = Array.from(board.querySelectorAll('game-tile'));\r\n\r\nconsole.log(\"Starting game.\")\r\n\r\nwindow.addEventListener('keydown', handleKey);\r\nplaceRandomToken();\r\n\r\nfunction handleKey(event: KeyboardEvent) {\r\n  if (!Object.keys(keyDirection).includes(event.key)) return;\r\n\r\n  const boardBeforeMove = stringify(board);\r\n\r\n  const direction = keyDirection[event.key as DirectionKey];\r\n  slideTokens(direction)\r\n\r\n  const boardAfterMove = stringify(board);\r\n\r\n  if (boardAfterMove === boardBeforeMove) {\r\n    console.log(\"BOARD HASN'T CHANGED\");\r\n    return;\r\n  }\r\n\r\n  setTimeout(placeRandomToken, 250);\r\n\r\n  if (!isMovePossible()) {\r\n    console.log(\"YOU LOST.\")\r\n    window.removeEventListener('keydown', handleKey);\r\n  }\r\n}\r\n\r\nfunction sortTilesIntoLanes(tiles: GameTile[], axisInfo: AxisInfo) {\r\n  const laneAxis: Axis = axisInfo.main;\r\n  return tiles.reduce((lanes: GameTile[][], tile) => {\r\n    const lane = tile[laneAxis];\r\n    if (lanes.hasOwnProperty(lane) && axisInfo.reversed) {\r\n      lanes[lane].unshift(tile);\r\n    } else if (lanes.hasOwnProperty(lane)) {\r\n      lanes[lane].push(tile);\r\n    } else {\r\n      lanes[lane] = [tile]\r\n    }\r\n    return lanes;\r\n  }, []);\r\n\r\n}\r\n\r\nfunction slideTokens(direction: Direction) {\r\n  const axisInfo = axes[direction];\r\n\r\n  let lanes: GameTile[][] = sortTilesIntoLanes(tiles, axisInfo)\r\n  lanes.forEach((lane) => {\r\n    let tokenMerged = false;\r\n    lane.forEach((tile, index) => {\r\n      const token = tile.querySelector('game-token') as GameToken;\r\n      if (!token) return;\r\n      slideSingleToken(index, lane, token, tokenMerged);\r\n    });\r\n  })\r\n\r\n}\r\n\r\nfunction slideSingleToken(index: number, lane: GameTile[], token: GameToken, tokenMerged: boolean) {\r\n  while (index > 0) {\r\n    index--;\r\n    const tileToCheck = lane[index];\r\n    const otherToken = tileToCheck.querySelector('game-token') as GameToken;\r\n    if (token.value === otherToken?.value && !tokenMerged) {\r\n      mergeOnNextTile(token, otherToken);\r\n      tokenMerged = true;\r\n      return;\r\n    } else if (otherToken) {\r\n      leaveOnCurrentTile(lane, index, token);\r\n      tokenMerged = false;\r\n      return;\r\n    }\r\n  }\r\n  leaveOnLastTile(lane, token);\r\n\r\n}\r\n\r\nfunction isMovePossible(): boolean {\r\n  const emptyTiles = getEmptyTiles(tiles);\r\n  if (emptyTiles) return true;\r\n\r\n  const vertAxisInfo = axes['down'];\r\n  const horAxisInfo = axes['right'];\r\n\r\n  let lanes: GameTile[][] = [\r\n    ...sortTilesIntoLanes(tiles, vertAxisInfo),\r\n    ...sortTilesIntoLanes(tiles, horAxisInfo)\r\n  ]\r\n  return lanes\r\n    .some(lane => lane\r\n      .some((tile, index) => {\r\n        if (index + 1 === lane.length) return false;\r\n        const token = tile.querySelector('game-token') as GameToken;\r\n        const nextToken = lane[index + 1].querySelector('game-token') as GameToken;\r\n        if (!(token && nextToken)) return false;\r\n        else if (token.value === nextToken.value) {\r\n          return true;\r\n        }\r\n      }))\r\n\r\n}\r\n\r\nfunction mergeOnNextTile(token: GameToken, otherToken: GameToken) {\r\n  token.value *= 2;\r\n  score.score = score.score + token.value;\r\n  otherToken.replaceWith(token);\r\n}\r\n\r\nfunction leaveOnCurrentTile(lane: GameTile[], searchIndex: number, token: GameToken) {\r\n  const previousTile = lane[searchIndex + 1];\r\n  previousTile.appendChild(token)\r\n}\r\n\r\nfunction leaveOnLastTile(lane: GameTile[], token: GameToken) {\r\n  lane[0].appendChild(token)\r\n}\r\n\r\nfunction getEmptyTiles(tiles: GameTile[]) {\r\n  return tiles\r\n    .filter(tile => Array.from(tile.children)\r\n      .every(child => !(child instanceof GameToken)));\r\n}\r\n\r\nfunction placeRandomToken() {\r\n  const emptyTiles = getEmptyTiles(tiles);\r\n  const randomIndex = Math.floor(Math.random() * emptyTiles.length);\r\n  const token = document.createElement('game-token');\r\n  emptyTiles[randomIndex].appendChild(token);\r\n}\r\n\r\n// stolen and modified from https://stackoverflow.com/questions/46880822/how-to-json-stringify-a-dom-element\r\nfunction stringify(element: Element) {\r\n  let obj: { name: string; attributes: Array<any>; children: Array<any> } = {\r\n    name: element.localName,\r\n    attributes: [],\r\n    children: [],\r\n  };\r\n\r\n  Array.from(element.attributes).forEach(a => {\r\n    obj.attributes.push({name: a.name, value: a.value});\r\n  });\r\n  Array.from(element.children).forEach(child => {\r\n    obj.children.push(stringify(child));\r\n  });\r\n\r\n  return JSON.stringify(obj);\r\n}\r\n"]}