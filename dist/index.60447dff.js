!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return r(t,e)}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||c(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t,e,n){return(l=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&_setPrototypeOf(o,n.prototype),o}).apply(null,arguments)}function f(t,e,n){return l.apply(null,arguments)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t){return h(t)}function y(t){var e="function"==typeof Map?new Map:void 0;return y=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return f(t,arguments,p(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,t)},y(t)}function d(t){return y(t)}function m(t,e){return!e||"object"!=((n=e)&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var n}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}var g=function(e){"use strict";i(o,e);var r=v(o);function o(){var e;return t(this,o),(e=r.call(this))._score=0,e.score=0,e}return n(o,[{key:"score",get:function(){return this._score},set:function(t){this._score=t,this.innerHTML="\n      <style>\n        game-score {\n          contain: content;\n          display: grid;\n          place-content: center;\n        }\n      </style>\n      <p>Score: ".concat(this._score,"</p>\n    ")}}]),o}(d(HTMLElement)),b=function(e){"use strict";i(o,e);var r=v(o);function o(){return t(this,o),r.apply(this,arguments)}return n(o,[{key:"connectedCallback",value:function(){var t;this.innerHTML="\n    <style>\n    game-tile {\n      display: grid;\n      contain: layout size style;\n      grid-auto-flow: row;\n      place-content: center;\n    }\n    </style>\n    ";var e,n=null!==(t=this.getAttribute("x"))&&void 0!==t?t:"";this.x=parseInt(n);var r=null!==(e=this.getAttribute("y"))&&void 0!==e?e:"";this.y=parseInt(r)}}]),o}(d(HTMLElement)),w=function(e){"use strict";i(o,e);var r=v(o);function o(){var e;return t(this,o),(e=r.apply(this,arguments)).tiles=[],e}return n(o,[{key:"createBoard",value:function(){var t=document.createElement("template");t.innerHTML="\n      <style>\n        game-board {\n          display: grid;\n          grid-template-columns: repeat(".concat(this.columns,", 1fr);\n          contain: content;\n        }\n      </style>"),this.replaceChildren(t.content);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++){var r=document.createElement("game-tile");r.setAttribute("x",n.toString()),r.setAttribute("y",e.toString()),this.appendChild(r),this.tiles.push(r)}}},{key:"connectedCallback",value:function(){console.log("game-board connected")}},{key:"attributeChangedCallback",value:function(){var t,e,n=null!==(t=this.getAttribute("rows"))&&void 0!==t?t:"4";this.rows=parseInt(n);var r=null!==(e=this.getAttribute("columns"))&&void 0!==e?e:"4";this.columns=parseInt(r),console.log("attributes changed"),this.createBoard()}}],[{key:"observedAttributes",get:function(){return["rows","columns"]}}]),o}(d(HTMLElement)),O=function(e){"use strict";i(o,e);var r=v(o);function o(){var e;return t(this,o),(e=r.apply(this,arguments)).value=2,e.init=!0,e}return n(o,[{key:"connectedCallback",value:function(){var t,e;this.init&&(this.id="id"+Math.random().toString(16).slice(2,10),this.setAttribute("id",this.id),this.init=!1,this.style.contain="content",this.style.display="grid",this.style.placeContent="center",this.style.placeItems="center",this.style.position="relative",this.style.animation="slide".concat(this.id," 250ms ease-in-out")),this.oldOffsetLeft=null!==(t=this.oldOffsetLeft)&&void 0!==t?t:this.offsetLeft,this.oldOffsetTop=null!==(e=this.oldOffsetTop)&&void 0!==e?e:this.offsetTop,this.innerHTML="\n    <style>\n      @keyframes slide".concat(this.id," {\n        from{\n          transform: translate(").concat(this.oldOffsetLeft-this.offsetLeft,"px, ").concat(this.oldOffsetTop-this.offsetTop,"px);\n        }\n        to {\n          transform: translate(0, 0);\n        }\n      }\n    </style>\n    <p>").concat(this.value,"</p>\n    "),this.oldOffsetTop=this.offsetTop,this.oldOffsetLeft=this.offsetLeft}}]),o}(d(HTMLElement)),A={"game-board":w,"game-token":O,"game-tile":b,"game-score":g},T={up:{main:"x",cross:"y",reversed:!1,length:"columns"},down:{main:"x",cross:"y",reversed:!0,length:"columns"},left:{main:"y",cross:"x",reversed:!1,length:"rows"},right:{main:"y",cross:"x",reversed:!0,length:"rows"}},k={ArrowLeft:"left",ArrowRight:"right",ArrowDown:"down",ArrowUp:"up"};Object.entries(A).forEach((function(t){var e=u(t),n=e[0],r=e[1];console.info("Registering <".concat(n,">")),customElements.define(n,r)}));var E=document.getElementsByTagName("game-board")[0],S=document.getElementsByTagName("game-score")[0],L=Array.from(E.querySelectorAll("game-tile"));function x(t,e){var n=e.main;return t.reduce((function(t,r){var o=r[n];return t.hasOwnProperty(o)&&e.reversed?t[o].unshift(r):t.hasOwnProperty(o)?t[o].push(r):t[o]=[r],t}),[])}function R(t,e){t.value*=2,S.score=S.score+t.value,e.replaceWith(t)}function j(t,e,n){t[e+1].appendChild(n)}function C(t){return t.filter((function(t){return Array.from(t.children).every((function(t){return!(t instanceof O)}))}))}function M(){var t=C(L),e=Math.floor(Math.random()*t.length),n=document.createElement("game-token");t[e].appendChild(n)}function _(t){var e={name:t.localName,attributes:[],children:[]};return Array.from(t.attributes).forEach((function(t){e.attributes.push({name:t.name,value:t.value})})),Array.from(t.children).forEach((function(t){e.children.push(_(t))})),JSON.stringify(e)}console.log("Starting game."),window.addEventListener("keydown",(function t(e){if(!Object.keys(k).includes(e.key))return;var n=_(E),r=k[e.key];if(function(t,e){x(t,T[e]).map((function(t){return t.forEach((function(e,n){var r=e.querySelector("game-token");r&&function(t,e,n,r){for(;t>0;){var o=e[--t].querySelector("game-token");if(n.value===(null==o?void 0:o.value)&&!r)return R(n,o),void(r=!0);if(o)return j(e,t,n),void(r=!1)}!function(t,e){t[0].appendChild(e)}(e,n)}(n,t,r,false)})),t}))}(L,r),_(E)===n)return void console.log("BOARD HASN'T CHANGED");setTimeout(M,250),function(){if(C(L))return!0;var t=T.right;return a(x(L,T.down)).concat(a(x(L,t))).some((function(t){return t.some((function(e,n){if(n+1===t.length)return!1;var r=e.querySelector("game-token"),o=t[n+1].querySelector("game-token");return!(!r||!o)&&(r.value===o.value||void 0)}))}))}()||(console.log("YOU LOST."),window.removeEventListener("keydown",t))})),M()}();
//# sourceMappingURL=index.60447dff.js.map
